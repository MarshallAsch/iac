---
- name: install various tools
  become: yes
  apt:
    pkg:
    - apt-transport-https
    - ca-certificates
    - software-properties-common
    - curl                    # command line http tool
    - wget                    # command line http tool

- name: install network tools
  become: yes
  apt:
    pkg:
    - arp-scan                # for ip <-> mac map search
    - dnsutils                # dig
    - ethtool                 # gets info like link speed
    - iftop                   # network top
    - iotop                   # disk top
    - net-tools               # ifconfig, netstat, arp
    - nmap                    # determine open ports
    - traceroute              # traceroute
    - nbtscan                 # netbios scanner
    - speedtest-cli           # bandwidth debugging
    - sshuttle                # forward ssh through tunnel
    - whois                   # whois
    - sqlite3                 # good db for integration tests
    - socat                   # sort of like nc but doesn't hang

# https://github.com/nickjj/ansible-docker
- name: Ensure docker is installed on the target system
  include_role:
    name: nickjj.docker
    apply:
      become: yes

- name: adding jason to group docker
  become: yes
  user:
    name: jason
    groups: docker
    append: yes

# pgp keys see: https://github.com/netson/ansible-gpg-key
# and https://github.com/cpmills1975/ansible-gpg-import-module
# and https://github.com/brandonkal/ansible-gpg
- name: Create gpg directory if it does not exist
  become_user: jason
  file:
    path: ~/.gpg
    state: directory
    mode: '0755'
    owner: jason
    group: jason

- name: gpg pub key copy
  become_user: jason
  copy:
    src: files/gpg/mygpgkey_pub.gpg
    dest: ~/.gpg/mygpgkey_pub.gpg
    owner: jason
    group: jason

- name: gpg priv key copy
  become_user: jason
  copy:
    src: files/gpg/mygpgkey_sec.gpg
    dest: ~/.gpg/mygpgkey_sec.gpg
    owner: jason
    group: jason

- name: import Public GPG Key from file
  become_user: jason
  gpg:
    key_file: ~/.gpg/mygpgkey_pub.gpg
    key_id: ernstjason1@gmail.com

- name: import private GPG Key from file
  become_user: jason
  gpg:
    key_file: ~/.gpg/mygpgkey_sec.gpg
    key_id: ernstjason1@gmail.com
    key_type: private

# enables the target to ssh into other machines I've deployed via ssh key
# ie: no password required
- name: ssh id_rsa
  become_user: jason
  copy:
    src: files/ssh/id_rsa
    dest: ~/.ssh/id_rsa
    owner: jason
    group: jason

- name: ssh id_rsa.pub
  become_user: jason
  copy:
    src: files/ssh/id_rsa.pub
    dest: ~/.ssh/id_rsa.pub
    owner: jason
    group: jason
